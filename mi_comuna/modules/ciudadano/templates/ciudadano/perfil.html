{% extends "base.html" %}

{% block title %}Perfil de Empresa{% endblock %}

{% block content %}
<section class="bg-gray-50 min-h-screen py-12">
  <div class="max-w-4xl mx-auto px-6">

    <!-- Título -->
    <div class="mb-10 text-center">
      <h1 class="text-3xl md:text-4xl font-extrabold text-gray-900">🏢 Perfil de Empresa</h1>
      <p class="mt-2 text-gray-600">Actualiza y administra la información de tu negocio.</p>
    </div>

    <!-- Mensajes flash -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="mb-6 space-y-2">
          {% for category, message in messages %}
            <div class="p-3 rounded text-sm
              {% if category == 'success' %} bg-green-100 text-green-800
              {% elif category == 'warning' %} bg-yellow-100 text-yellow-800
              {% elif category == 'danger' %} bg-red-100 text-red-800
              {% else %} bg-blue-100 text-blue-800 {% endif %}">
              {{ message }}
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <!-- Formulario -->
    <form method="POST" enctype="multipart/form-data"
          class="bg-white p-8 rounded-2xl shadow-md space-y-6 border border-gray-200">
      {{ form.hidden_tag() }}

      <!-- Nombre -->
      <div>
        {{ form.nombre.label(class="block text-sm font-semibold text-gray-700 mb-1") }}
        {{ form.nombre(class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring focus:ring-blue-200") }}
        {% for error in form.nombre.errors %}
          <p class="text-red-500 text-sm mt-1">{{ error }}</p>
        {% endfor %}
      </div>

      <!-- Descripción -->
      <div>
        {{ form.descripcion.label(class="block text-sm font-semibold text-gray-700 mb-1") }}
        {{ form.descripcion(class="w-full px-4 py-2 h-28 rounded-lg border border-gray-300 focus:ring focus:ring-blue-200") }}
      </div>

      <!-- Dirección -->
      <div>
        {{ form.direccion.label(class="block text-sm font-semibold text-gray-700 mb-1") }}
        {{ form.direccion(class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring focus:ring-blue-200") }}
      </div>

      <!-- Teléfonos -->
      <div class="grid md:grid-cols-2 gap-6">
        <div>
          {{ form.telefono.label(class="block text-sm font-semibold text-gray-700 mb-1") }}
          {{ form.telefono(class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring focus:ring-blue-200") }}
        </div>
        <div>
          {{ form.whatsapp.label(class="block text-sm font-semibold text-gray-700 mb-1") }}
          {{ form.whatsapp(class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring focus:ring-green-200") }}
        </div>
      </div>

      <!-- Email y Web -->
      <div class="grid md:grid-cols-2 gap-6">
        <div>
          {{ form.email.label(class="block text-sm font-semibold text-gray-700 mb-1") }}
          {{ form.email(class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring focus:ring-blue-200") }}
        </div>
        <div>
          {{ form.sitio_web.label(class="block text-sm font-semibold text-gray-700 mb-1") }}
          {{ form.sitio_web(class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring focus:ring-blue-200") }}
        </div>
      </div>

      <!-- Redes Sociales -->
      <div class="grid md:grid-cols-3 gap-6">
        <div>
          {{ form.facebook.label(class="block text-sm font-semibold text-gray-700 mb-1") }}
          {{ form.facebook(class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring focus:ring-blue-200") }}
        </div>
        <div>
          {{ form.instagram.label(class="block text-sm font-semibold text-gray-700 mb-1") }}
          {{ form.instagram(class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring focus:ring-pink-200") }}
        </div>
        <div>
          {{ form.tiktok.label(class="block text-sm font-semibold text-gray-700 mb-1") }}
          {{ form.tiktok(class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring focus:ring-purple-200") }}
        </div>
      </div>

      <!-- Categoría -->
      <div>
        {{ form.categoria_id.label(class="block text-sm font-semibold text-gray-700 mb-1") }}
        {{ form.categoria_id(class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring focus:ring-blue-200") }}
      </div>

      <!-- Logo -->
      <div>
        {{ form.logo.label(class="block text-sm font-semibold text-gray-700 mb-1") }}
        {{ form.logo(class="block w-full text-sm text-gray-600
                           file:mr-4 file:py-2 file:px-4
                           file:rounded-lg file:border-0
                           file:text-sm file:font-semibold
                           file:bg-blue-600 file:text-white
                           hover:file:bg-blue-700 cursor-pointer") }}
        {% if perfil and perfil.logo %}
          <div class="mt-3">
            <p class="text-sm text-gray-600">Logo actual:</p>
            <img src="{{ url_for('static', filename=perfil.logo) }}"
                 alt="Logo empresa"
                 class="h-20 mt-2 rounded-lg shadow border border-gray-200">
          </div>
        {% endif %}
      </div>

      <!-- Horario -->
      <div>
        {{ form.horario.label(class="block text-sm font-semibold text-gray-700 mb-1") }}
        {{ form.horario(class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring focus:ring-blue-200") }}
      </div>

      <!-- Botón -->
      <div class="text-center pt-4">
        {{ form.submit(class="px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg shadow hover:bg-blue-700 transition") }}
      </div>
    </form>

    <!-- Enlace de retorno -->
    <div class="text-center mt-8">
      <a href="{{ url_for('ciudadano.dashboard') }}" class="text-indigo-600 hover:underline text-sm">
        ⬅️ Volver al Panel
      </a>
    </div>
  </div>
</section>
{% endblock %}
